---
globs: plugins/woocommerce-venezuela-pro-2025/**/*
description: Reglas espec√≠ficas para el plugin WooCommerce Venezuela Suite (Pro 2025)
---

# WooCommerce Venezuela Suite - Plugin Rules

## Visi√≥n del Proyecto

**WooCommerce Venezuela Suite 2025** es un plugin completamente modular donde cada funcionalidad es un componente independiente que puede activarse/desactivarse desde el panel de administraci√≥n. Esto facilita el debugging, mantenimiento y permite a los usuarios personalizar exactamente lo que necesitan.

## Documentaci√≥n del Proyecto

- **Plan Integral**: [COMPREHENSIVE-PLAN.md](mdc:plugins/woocommerce-venezuela-pro-2025/docs/COMPREHENSIVE-PLAN.md)
- **Hallazgos de Investigaci√≥n**: [RESEARCH-FINDINGS.md](mdc:plugins/woocommerce-venezuela-pro-2025/docs/RESEARCH-FINDINGS.md)
- **Plan Modular**: [MODULAR-PLAN.md](mdc:plugins/woocommerce-venezuela-pro-2025/docs/MODULAR-PLAN.md)
- **Plan Mejorado**: [IMPROVED-PLAN.md](mdc:plugins/woocommerce-venezuela-pro-2025/docs/IMPROVED-PLAN.md)
- **Estructura MVP**: [MVP-STRUCTURE.md](mdc:plugins/woocommerce-venezuela-pro-2025/MVP-STRUCTURE.md)
- **Project Brief**: [PROJECT-BRIEF.md](mdc:plugins/woocommerce-venezuela-pro-2025/docs/PROJECT-BRIEF.md)
- **Arquitectura T√©cnica**: [TECHNICAL-ARCHITECTURE.md](mdc:plugins/woocommerce-venezuela-pro-2025/docs/TECHNICAL-ARCHITECTURE.md)
- **Reglas de Cursor**: [CURSOR-DEVELOPMENT-RULES.md](mdc:plugins/woocommerce-venezuela-pro-2025/docs/CURSOR-DEVELOPMENT-RULES.md)

## Estructura del Plugin

Este plugin sigue la arquitectura est√°ndar de WordPress con las siguientes caracter√≠sticas:

### Archivos Principales
- **Plugin Bootstrap**: [woocommerce-venezuela-pro-2025.php](mdc:plugins/woocommerce-venezuela-pro-2025/woocommerce-venezuela-pro-2025.php) - Punto de entrada principal
- **Clase Core**: [class-woocommerce-venezuela-pro-2025.php](mdc:plugins/woocommerce-venezuela-pro-2025/includes/class-woocommerce-venezuela-pro-2025.php) - Funcionalidad principal
- **Admin**: [class-woocommerce-venezuela-pro-2025-admin.php](mdc:plugins/woocommerce-venezuela-pro-2025/admin/class-woocommerce-venezuela-pro-2025-admin.php) - Funcionalidad del admin
- **Public**: [class-woocommerce-venezuela-pro-2025-public.php](mdc:plugins/woocommerce-venezuela-pro-2025/public/class-woocommerce-venezuela-pro-2025-public.php) - Funcionalidad p√∫blica

### Convenciones de Nomenclatura

1. **Clases**: Usar prefijo `Woocommerce_Venezuela_Pro_2025_` seguido del prop√≥sito
2. **Constantes**: Usar `WOOCOMMERCE_VENEZUELA_PRO_2025_` como prefijo
3. **Funciones**: Usar snake_case con prefijo `woocommerce_venezuela_pro_2025_`
4. **Hooks**: Usar `woocommerce_venezuela_pro_2025_` como prefijo

### Estructura de Directorios

```
woocommerce-venezuela-pro-2025/
‚îú‚îÄ‚îÄ admin/           # Funcionalidad del √°rea de administraci√≥n
‚îú‚îÄ‚îÄ includes/        # Clases principales del plugin
‚îú‚îÄ‚îÄ public/          # Funcionalidad del frontend
‚îú‚îÄ‚îÄ languages/       # Archivos de traducci√≥n
‚îî‚îÄ‚îÄ assets/          # CSS, JS y otros recursos
```

## Reglas de Desarrollo

### 1. Seguridad
- Siempre verificar `! defined( 'WPINC' )` antes de ejecutar c√≥digo
- Usar `wp_nonce_field()` para formularios del admin
- Sanitizar todas las entradas de usuario con `sanitize_text_field()`, `sanitize_email()`, etc.
- Validar permisos con `current_user_can()`

### 2. Hooks y Filtros
- Registrar hooks en el constructor de las clases correspondientes
- Usar el Loader para gestionar todos los hooks: `$this->loader->add_action()`
- Prefijo de hooks: `woocommerce_venezuela_pro_2025_`

### 3. Internacionalizaci√≥n
- Usar `__()`, `_e()`, `esc_html__()` para strings traducibles
- Text domain: `woocommerce-venezuela-pro-2025`
- Cargar traducciones en `plugins_loaded`

### 4. WooCommerce Integration
- Verificar que WooCommerce est√© activo antes de ejecutar funcionalidad espec√≠fica
- Usar hooks de WooCommerce cuando sea apropiado
- Seguir las convenciones de WooCommerce para customizaci√≥n

### 5. Assets (CSS/JS)
- Enqueue scripts/styles en las clases Admin y Public correspondientes
- Usar versioning para cache busting: `$this->version`
- Minificar assets en producci√≥n

### 6. Base de Datos
- Usar `$wpdb` para consultas directas
- Crear tablas en el activador si es necesario
- Limpiar datos en el desactivador

### 7. Logging y Debug
- Usar `error_log()` para debugging
- Implementar sistema de logging personalizado si es necesario
- No dejar c√≥digo de debug en producci√≥n

## Arquitectura Modular

### Sistema de M√≥dulos Activables/Desactivables
- **Gesti√≥n Independiente**: Cada m√≥dulo puede activarse/desactivarse desde el admin
- **Carga Condicional**: Solo se cargan los m√≥dulos activos
- **Debugging Simplificado**: Aislar problemas por m√≥dulo
- **Configuraci√≥n Individual**: Cada m√≥dulo tiene su propia configuraci√≥n

### M√≥dulos MVP (M√≠nimo Viable)

#### M√≥dulo 1: Gestor de Moneda Inteligente üíµ
- **Conversi√≥n Autom√°tica**: USD ‚Üí VES usando tasa BCV
- **Visualizaci√≥n Dual**: Precios en ambas monedas
- **Selector de Moneda**: Cliente elige moneda de pago
- **Cache Inteligente**: Sistema de cache para conversiones
- **Integraci√≥n WooCommerce**: Configuraci√≥n de moneda base

#### M√≥dulo 2: Pasarelas de Pago Locales üí≥
- **Pago M√≥vil (C2P)**: Con validaci√≥n de referencia
- **Zelle**: Pasarela informativa con confirmaci√≥n
- **Transferencias Bancarias**: M√∫ltiples cuentas venezolanas
- **Integraci√≥n WooCommerce**: M√©todos de pago nativos

#### M√≥dulo 3: Sistema de Impuestos Venezolanos üßæ
- **IVA Configurable**: Integrado con sistema nativo de WooCommerce (no hardcodeado)
- **IGTF Din√°mico**: Configurable y actualizable autom√°ticamente desde fuentes oficiales
- **Actualizaci√≥n Autom√°tica**: Tasas desde APIs oficiales (SENIAT, BCV)
- **Campos Personalizados**: C√©dula/RIF en checkout con validaci√≥n
- **Notificaciones**: Alertas de cambios en tasas fiscales

#### M√≥dulo 4: Env√≠os Nacionales üöö
- **MRW**: Tarifas por peso y destino
- **Zoom**: Integraci√≥n con API
- **Tealca**: M√©todo configurable
- **Integraci√≥n WooCommerce**: M√©todos de env√≠o nativos

### M√≥dulos Opcionales (Post-MVP)
- **Integraci√≥n BCV D√≥lar Tracker**: Conexi√≥n con plugin existente
- **Sistema de Actualizaci√≥n Autom√°tica**: Tasas desde fuentes oficiales
- **Notificaciones WhatsApp**: Confirmaciones autom√°ticas
- **Reportes y Analytics**: Estad√≠sticas avanzadas
- **Campos de Checkout Personalizados**: Validaci√≥n venezolana

### Sistema de Actualizaci√≥n Autom√°tica
- **Tasas Din√°micas**: IVA e IGTF desde APIs oficiales (SENIAT, BCV)
- **Cron Jobs**: Actualizaci√≥n autom√°tica configurable (hora/d√≠a/semana)
- **Notificaciones**: Alertas por email de cambios significativos
- **Fallback Manual**: Tasas manuales cuando no hay conexi√≥n
- **Historial**: Registro de cambios de tasas fiscales

## Hallazgos de Investigaci√≥n

### Mercado Venezolano 2024-2025
- **E-commerce**: Crecimiento del 35% anual
- **Pago M√≥vil**: 78% de preferencia en transacciones
- **Criptomonedas**: USDT y BTC en crecimiento (30% uso)
- **Facturaci√≥n Electr√≥nica**: Obligatoria desde 2024
- **Delivery Local**: M√°s demandado que env√≠os nacionales

### M√©todos de Pago Populares
1. **Pago M√≥vil (C2P)**: 78% de preferencia
2. **Transferencias Bancarias**: 65% de uso
3. **Zelle**: 45% para pagos en USD
4. **Binance Pay**: 30% para criptomonedas
5. **Cashea**: 25% para financiamiento

### Empresas de Env√≠o Principales
1. **MRW**: 40% del mercado nacional
2. **Zoom**: 25% del mercado
3. **Tealca**: 15% del mercado
4. **Domesa**: 10% del mercado

### Regulaciones Fiscales Cr√≠ticas
- **Providencias 00102 y 00121**: Facturaci√≥n electr√≥nica obligatoria
- **Firma Digital**: Requerida para facturas electr√≥nicas
- **IVA Variable**: No fijo, seg√∫n producto/servicio
- **IGTF**: 3% solo para divisas extranjeras
- **Protecci√≥n de Datos**: Ley de Infogobierno obligatoria

## Integraci√≥n con Ecosistema

### BCV D√≥lar Tracker
- **API Integration**: Uso de la API existente
- **Fallback System**: Respaldo cuando no est√© disponible
- **Cache Sharing**: Aprovechar cache del plugin BCV

### Tema Electro
- **Compatibilidad**: Funcionamiento √≥ptimo garantizado
- **Personalizaciones**: Adaptado para productos el√©ctricos
- **Responsive**: Optimizado para m√≥viles

### Plugin Kinta Electronic Elementor
- **Widgets**: Integraci√≥n con widgets especializados
- **Elementos**: Compatibilidad con elementos personalizados

## Sistema de Ayuda Integrado

### Ayuda por M√≥dulo
- **¬øQu√© hace?**: Explicaci√≥n clara de cada funcionalidad
- **¬øC√≥mo configurar?**: Pasos espec√≠ficos en WooCommerce
- **¬øD√≥nde encontrar?**: Enlaces directos a configuraciones
- **¬øProblemas comunes?**: Soluciones frecuentes
- **¬øDependencias?**: Qu√© otros m√≥dulos necesita

### Enlaces Directos a WooCommerce
- **Configuraci√≥n de Moneda**: WooCommerce > Configuraci√≥n > General
- **M√©todos de Pago**: WooCommerce > Configuraci√≥n > Pagos
- **Sistema de Impuestos**: WooCommerce > Configuraci√≥n > Impuestos
- **M√©todos de Env√≠o**: WooCommerce > Configuraci√≥n > Env√≠os
- **Campos de Checkout**: WooCommerce > Configuraci√≥n > Avanzado

### Gu√≠as de Configuraci√≥n
- **IVA Configurable**: Integrar con sistema nativo de WooCommerce (no hardcodeado)
- **IGTF Din√°mico**: Configurable y actualizable autom√°ticamente desde fuentes oficiales
- **Actualizaci√≥n Autom√°tica**: Configurar frecuencia de actualizaci√≥n de tasas
- **Moneda VES**: Establecer como moneda base
- **Zonas de Env√≠o**: Crear zonas para estados venezolanos
- **M√©todos de Pago**: Activar pasarelas locales
- **Notificaciones**: Configurar alertas de cambios en tasas fiscales

## Testing y Debugging

### Herramientas de Desarrollo
- **M√≥dulos Independientes**: Activar/desactivar para debugging
- **Logs Espec√≠ficos**: Por m√≥dulo para identificar problemas
- **Testing Incremental**: Probar cada m√≥dulo por separado
- **WP_DEBUG**: Para debugging general

### Validaci√≥n
- **Compatibilidad WooCommerce**: Probar con diferentes versiones
- **Temas Populares**: Verificar funcionamiento
- **Otros Plugins**: Evitar conflictos
- **Configuraciones Servidor**: Diferentes entornos